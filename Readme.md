# Что это было ?

Мне было очень интересно понять как писать на гошке бекенд и чем это отличается от того же Nodejs/Python <br>
Мой опыт в Go составлял 1 просмотренный гайд и частое зависание на демке с кодом гошки : )

Вот я и решил написать небольшой проектик для коллекционирования матерных паст <br>
Как по мне, получилось очень даже неплохо. Для создания своего апи брал за основу реализацию с проекта, где я был фронтендером

Гошка мне 50/50. Я просто не могу не писать кучу дженериков, не делать сложные типы и не работать с чем-то таким <br>
Гошка мне показалась маленькой и простой, но в то же время сложной и непонятной, но в целом прикольно

## Полученный опыт

1. Как пишется бекенд на go
2. Что все sql билдеры дерьмо
3. Что в бекенд соваться мне не надо

## Что реализовал ?

Круды для `/pastes` и `/users`

Не стал делать сваггер, нервов не хватило, но вот вкратце, что получилось<br>

Предполагалось, что я напишу для этого небольшой клиент (НЕ ВЕБ), но решил пока оставить эту идею

Кстати, чтобы подёргать любой эндпоинт нужно передавать секретный ключ из .env в Authorization. Сделал так, ибо предполагалось не давать возможности другому человеку дёргать API

### `/pastes`

1. GET

Query параметры:

| Название в url | Описание                                                     |
| -------------- | ------------------------------------------------------------ |
| search         | Текстовый параметр поиска по названию пасты/описанию         |
| strict         | Индикатор, позволяющий выявлять строгое/частичное совпадение |
| userId         | Пасты конкретного автора                                     |
| pasteId        | Айди нужной пасты                                            |

Тело ответа:

```json
{
    "id": int,
    "title": string,
    "paste": string,
    "userId": int,
    "createdAt": Date,
    "createdAt": Date
}
```

2. Post

Тело запроса:

```json
{
    "title": string,
    "paste": string,
    "userId": int,
}
```

3. Put

Query параметры:

| Название в url | Описание                                                     |
| -------------- | ------------------------------------------------------------ |
| search         | Текстовый параметр поиска по названию пасты/описанию         |
| strict         | Индикатор, позволяющий выявлять строгое/частичное совпадение |
| userId         | Пасты конкретного автора                                     |
| pasteId        | Айди нужной пасты                                            |

Тело запроса:

```json
{
    "title": string,
    "paste": string,
}
```

Тело ответа:

```json
{
    "id": int,
    "title": string,
    "paste": string,
    "userId": int,
    "createdAt": Date,
    "createdAt": Date
}
```

4. Delete

Query параметры:

| Название в url | Описание                                                     |
| -------------- | ------------------------------------------------------------ |
| search         | Текстовый параметр поиска по названию пасты/описанию         |
| strict         | Индикатор, позволяющий выявлять строгое/частичное совпадение |
| userId         | Пасты конкретного автора                                     |
| pasteId        | Айди нужной пасты                                            |

### /pastes/search

Этот эндпоинт имеет 2 основных парамера:

1. Pagination
2. Filter

Query параметры для Pagination

| Название в url | Описание                                                                          |
| -------------- | --------------------------------------------------------------------------------- |
| order          | В каком направлении (next, prev)                                                  |
| startFrom      | С какого айди начинать пагинацию                                                  |
| limit          | Какое кол-во паст нужно выдать в ответе (5, 10, 15, 20, 25, 30, 35, 40, 45, 50)   |
| sort           | Элементы в ответе будут расположены по возрастанию или убыванию их id (ASC, DESC) |

Про order и startFrom:

Если выбрано next, то будет искать по `id > startFrom` <br>
Если выбрано prev, то будет искать по `id < startFrom` <br>

Query параметры для Filter:

| Название в url | Описание                                                     |
| -------------- | ------------------------------------------------------------ |
| search         | Текстовый параметр поиска по названию пасты/описанию         |
| strict         | Индикатор, позволяющий выявлять строгое/частичное совпадение |
| userId         | Пасты конкретного автора                                     |
| pasteId        | Айди нужной пасты                                            |

Тело ответа:

```json
{
    "items": [
        {
            "id": int,
            "title": string,
            "paste": string,
            "userId": int,
            "createdAt": Date,
            "createdAt": Date
        }
    ],
    "hasNext": boolean
}
```

### /users

1. GET

Query параметры:

| Название в url | Описание                                             |
| -------------- | ---------------------------------------------------- |
| id             | Поиск по id пользователя                             |
| username       | Поиск по username (уникально)                        |
| displayName    | Поиск по displayName (не уникально)                  |
| socialId       | Поиск по айди соц. сети                              |
| matchAll       | Если true, то в sql применяется AND вместо OR        |
| strict         | Ищет по строгому совпадению username или displayName |

Тело ответа:

```json
{
    "id": int,
    "username": string,
    "displayName": string,
    "socialId": string,
    "createdAt": Date,
    "updatedAt": Date
}
```

2. POST

Тело запроса:

```json
{
    "username": string,
    "displayName": string,
    "socialId": string
}
```

Тело ответа:

```json
{
    "id": int,
    "username": string,
    "displayName": string,
    "socialId": string,
    "createdAt": Date,
    "updatedAt": Date
}
```

3. PUT

Query параметры:

| Название в url | Описание                                             |
| -------------- | ---------------------------------------------------- |
| id             | Поиск по id пользователя                             |
| username       | Поиск по username (уникально)                        |
| displayName    | Поиск по displayName (не уникально)                  |
| socialId       | Поиск по айди соц. сети                              |
| matchAll       | Если true, то в sql применяется AND вместо OR        |
| strict         | Ищет по строгому совпадению username или displayName |

Тело запроса:

```json
{
    "username": string,
    "displayName": string
}
```

Тело ответа:

```json
{
    "id": int,
    "username": string,
    "displayName": string,
    "socialId": string,
    "createdAt": Date,
    "updatedAt": Date
}
```

4. DELETE

Query параметры:

| Название в url | Описание                                             |
| -------------- | ---------------------------------------------------- |
| id             | Поиск по id пользователя                             |
| username       | Поиск по username (уникально)                        |
| displayName    | Поиск по displayName (не уникально)                  |
| socialId       | Поиск по айди соц. сети                              |
| matchAll       | Если true, то в sql применяется AND вместо OR        |
| strict         | Ищет по строгому совпадению username или displayName |


### 422

Не очень умные, но +- окей

```json
{
    "message": string,
    "violations":{
        "message": string,
        "propertyPath": string
    }
}
```


## Спасибо за прочтение

Вот вам красивая аниме тяночка
![image.png](image.png)
